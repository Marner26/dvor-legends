<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dvor Legends üî•</title>
<style>
/* Body & fonts */
body {
    margin:0; padding:0; font-family: 'Arial', sans-serif;
    background: linear-gradient(160deg,#0f0f1a,#1a001f);
    color:white; text-align:center;
}
h1 { 
    color:#ff00ff; text-shadow:2px 2px #00ffff; font-size:3rem;
    margin-top:20px;
}

/* Buttons */
button {
    background:#1f1f3d; color:#00ffff;
    border-radius:10px; padding:12px 25px;
    margin:5px; cursor:pointer; font-weight:bold;
    transition: all 0.3s ease;
}
button:hover {
    transform: scale(1.1);
    color:#ff00ff;
}

/* Stats */
#stats {
    display:flex; justify-content:center; gap:15px; margin-top:10px; flex-wrap:wrap;
}
.stat {
    background:#1f1f3d; border-radius:10px; padding:15px; min-width:90px;
    transition: transform 0.3s ease;
}
.stat.bump { transform: scale(1.2); }

/* Chat box */
#chat {
    background:#10101f; border:2px solid #00ffff;
    border-radius:15px; padding:15px;
    width:400px; max-height:250px; overflow-y:auto;
    margin:20px auto; font-size:14px;
}

/* Leaderboard */
#leaderboard {
    background:#1f1f3d; border:2px solid #00ffff;
    border-radius:15px; padding:15px; width:250px; margin:20px auto;
    text-align:left; font-size:14px;
}
#leaderboard li { margin:5px 0; }

/* Login & game screen */
#loginScreen { margin-top:50px; }
#gameScreen { display:none; margin-top:20px; }

/* Input fields */
input[type=text] {
    border-radius:10px; border:none; padding:10px;
    width:200px; margin:5px; text-align:center;
}

/* Mobile */
@media (max-width:600px){
    #chat { width:90%; }
    #stats { flex-direction:column; gap:10px; }
    button { font-size:14px; padding:10px 15px; }
}
</style>
</head>
<body>

<h1>Dvor Legends üî•</h1>

<div id="loginScreen">
    <input type="text" id="username" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫">
    <button id="joinBtn">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</button>
</div>

<div id="gameScreen">
    <div id="stats">
        <div class="stat" id="street">–†–µ–ø —É–ª–∏—Ü: 0 üî•</div>
        <div class="stat" id="meme">–ú–µ–º—ã: 0 üòÇ</div>
        <div class="stat" id="smart">–£–º: 0 üß†</div>
        <div class="stat" id="drip">–°—Ç–∏–ª—å: 0 üëï</div>
    </div>

    <button id="rapBattleBtn">–†—ç–ø –±–∞—Ç—Ç–ª üé§</button>

    <div id="chat"></div>
    <input type="text" id="msgInput" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ">
    <button id="sendBtn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>

    <div id="leaderboard">
        <h2>–¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤</h2>
        <ul id="topPlayers"></ul>
    </div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
const socket = io();

const loginScreen = document.getElementById("loginScreen");
const gameScreen = document.getElementById("gameScreen");
const usernameInput = document.getElementById("username");
const joinBtn = document.getElementById("joinBtn");

const streetEl = document.getElementById("street");
const memeEl = document.getElementById("meme");
const smartEl = document.getElementById("smart");
const dripEl = document.getElementById("drip");

const chatEl = document.getElementById("chat");
const msgInput = document.getElementById("msgInput");
const sendBtn = document.getElementById("sendBtn");

const leaderboardEl = document.getElementById("topPlayers");

let username = "";

joinBtn.onclick = () => {
    username = usernameInput.value.trim();
    if(!username) return alert("–í–≤–µ–¥–∏—Ç–µ –Ω–∏–∫!");
    socket.emit("joinGame", username);
    loginScreen.style.display = "none";
    gameScreen.style.display = "block";
};

document.getElementById("rapBattleBtn").onclick = () => {
    socket.emit("rapBattle");
};

sendBtn.onclick = () => {
    const msg = msgInput.value.trim();
    if(!msg) return;
    socket.emit("chatMessage", msg);
    msgInput.value = "";
};

socket.on("chatMessage", (data) => {
    const div = document.createElement("div");
    div.textContent = `${data.username}: ${data.message}`;
    chatEl.appendChild(div);
    chatEl.scrollTop = chatEl.scrollHeight;
});

socket.on("updatePlayers", (players) => {
    const player = players[socket.id];
    if(!player) return;

    // Animate stat bump
    [streetEl, memeEl, smartEl, dripEl].forEach(el => el.classList.remove("bump"));

    streetEl.textContent = `–†–µ–ø —É–ª–∏—Ü: ${player.street} üî•`;
    streetEl.classList.add("bump");
    memeEl.textContent = `–ú–µ–º—ã: ${player.meme} üòÇ`;
    memeEl.classList.add("bump");
    smartEl.textContent = `–£–º: ${player.smart} üß†`;
    smartEl.classList.add("bump");
    dripEl.textContent = `–°—Ç–∏–ª—å: ${player.drip} üëï`;
    dripEl.classList.add("bump");
});

socket.on("updateLeaderboard", (players) => {
    leaderboardEl.innerHTML = "";
    players.forEach((p, i) => {
        const li = document.createElement("li");
        li.textContent = `${i+1}. ${p.username} - –†–µ–ø: ${p.street} üî•`;
        if(i===0) li.style.color = "#ffd700"; // gold for top
        leaderboardEl.appendChild(li);
    });
});
</script>

</body>
</html>
